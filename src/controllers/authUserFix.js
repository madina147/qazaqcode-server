const authUser = async (req, res) => { try { const { login, password } = req.body; const user = await User.findOne({ login }); if (user && (await user.matchPassword(password))) { res.json({ _id: user._id, firstName: user.firstName, lastName: user.lastName, login: user.login, role: user.role, token: generateToken(user._id), }); } else { res.status(401).json({ message: "Invalid login or password" }); } } catch (error) { console.error("Auth error:", error); res.status(500).json({ message: "Server error" }); } };
